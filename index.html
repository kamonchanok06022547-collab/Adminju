<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ADMIN MONITOR - LEKWIN JUNIOR</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        :root { --primary: #1565c0; --success: #00e676; --gray: #cfd8dc; }
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: #e3f2fd; padding: 20px 10px; display: flex; flex-direction: column; align-items: center; }
        .container { width: 100%; max-width: 600px; }
        .card { background: #fff; border-radius: 20px; padding: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 20px; }
        
        /* Grid ‡∏î‡∏π‡∏£‡∏´‡∏±‡∏™ - ‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏µ‡πÉ‡∏´‡πâ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô */
        .code-grid { 
            display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); 
            gap: 8px; padding: 10px; background: #f8f9fa; border-radius: 12px; 
        }
        .badge { 
            font-size: 0.7rem; padding: 8px 4px; border-radius: 8px; text-align: center; 
            border: 1px solid #eee; font-weight: bold; background: white; color: #bbb;
        }
        /* ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ï‡∏≠‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå */
        .badge.on { 
            background: #00e676 !important; 
            color: white !important; 
            border-color: #00c853 !important;
            box-shadow: 0 0 10px rgba(0, 230, 118, 0.5);
        }

        table { width: 100%; border-collapse: collapse; }
        th { text-align: left; padding: 10px; font-size: 0.8rem; background: #fce4ec; }
        td { padding: 10px; border-bottom: 1px solid #eee; font-size: 0.85rem; }
        .dot { height: 12px; width: 12px; border-radius: 50%; display: inline-block; background: var(--gray); }
        .dot.online { background: var(--success); box-shadow: 0 0 8px var(--success); }
        
        input { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd; margin-bottom: 10px; }
        button { cursor: pointer; border: none; border-radius: 8px; padding: 8px 12px; font-weight: bold; }
        .btn-add { background: var(--primary); color: white; width: 100%; padding: 12px; }
        .btn-kick { background: #ffb74d; color: white; }
    </style>
</head>
<body>

<div id="main" class="container">
    <div style="text-align:center; margin-bottom:20px;">
        <img src="https://i.pinimg.com/1200x/7a/82/11/7a8211a2161799550aa868aaab6d5c84.jpg" style="width:80px; border-radius:15px;">
        <h2 style="color:var(--primary);">ADMIN SYSTEM</h2>
    </div>

    <div class="card">
        <h3>üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß = ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)</h3>
        <div id="gridStatus" class="code-grid"></div>
    </div>

    <div class="card">
        <h3>üë• ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3>
        <table>
            <thead><tr><th>‡∏£‡∏´‡∏±‡∏™</th><th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th><th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th></tr></thead>
            <tbody id="userList"></tbody>
        </table>
    </div>

    <div class="card">
        <h3>‚ûï ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ä‡∏±‡πà‡∏ß‡∏Ñ‡∏£‡∏≤‡∏ß</h3>
        <input id="newCode" type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà">
        <button class="btn-add" onclick="addCode()">‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏´‡∏°‡πà</button>
    </div>
</div>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyC1iAT_0vKk6Uew2VJtN3_wx4JszVTTTjY",
    authDomain: "junior-nior.firebaseapp.com",
    databaseURL: "https://junior-nior-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "junior-nior",
    storageBucket: "junior-nior.firebasestorage.app",
    messagingSenderId: "225309280850",
    appId: "1:225309280850:web:49e3f857eb8a4a250a2d8b"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const FIXED_CODES = ["winju0101","juwin0202","jujuwin0303","lekwinju0404","winlek0505","jueiei0606","juny0707","niorwin0808","winnior0909","winarrai1010","lnwwinju1111","julnwwin1212","asdf1313","zxcv1414","qwer1616","popo1717","ziber1818","fahsai1919","kaimook2020","rich9999","gold8888","lucky789","money168","winwin24","star555","smile11","power88","bestwin9","junior007"];

function updateMonitor() {
    db.ref().on('value', (snap) => {
        const data = snap.val() || {};
        const onlineUsers = data.online_users || {};
        const customCodes = data.custom_codes || {};

        // 1. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Grid (‡∏£‡∏ß‡∏°‡∏£‡∏´‡∏±‡∏™‡∏ñ‡∏≤‡∏ß‡∏£ + ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏≠‡∏á)
        const grid = document.getElementById("gridStatus");
        grid.innerHTML = "";
        const all = [...FIXED_CODES, ...Object.keys(customCodes)];

        all.forEach(code => {
            // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç: ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏£‡∏´‡∏±‡∏™‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô online_users ‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà offline ‡πÉ‡∏´‡πâ‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
            const userData = onlineUsers[code];
            const isOnline = userData && (userData.status === 'online' || userData.status === undefined);
            
            grid.innerHTML += `<div class="badge ${isOnline ? 'on' : ''}">${code}</div>`;
        });

        // 2. ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        const table = document.getElementById("userList");
        table.innerHTML = "";
        Object.keys(onlineUsers).forEach(key => {
            const u = onlineUsers[key];
            if(u.status !== 'offline') { // ‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà offline
                table.innerHTML += `
                    <tr>
                        <td><strong>${key}</strong></td>
                        <td><span class="dot online"></span> ‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</td>
                        <td><button class="btn-kick" onclick="kick('${key}')">‡πÄ‡∏ï‡∏∞</button></td>
                    </tr>`;
            }
        });
    });
}

function addCode() {
    const c = document.getElementById("newCode").value.trim();
    if(c) db.ref('custom_codes/'+c).set(true).then(()=>document.getElementById("newCode").value="");
}

function kick(key) {
    if(confirm('‡πÄ‡∏ï‡∏∞‡∏£‡∏´‡∏±‡∏™ '+key+'?')) {
        db.ref('online_users/'+key).remove();
    }
}

updateMonitor();
</script>
</body>
</html>
